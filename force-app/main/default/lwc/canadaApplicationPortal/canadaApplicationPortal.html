<template>
    <div class="container">
        <template if:true={frontPage}>
            <div class="brochure">
                <div class="brochureImage">
                    <template if:true={showLogo}>
                        <div class="eazeLogo">
                            <img src={logoImage} alt="Eaze Logo" class="eazeLogoIMG"/>
                        </div>
                    </template>
                    <div class="YourClients">
                        <div><b>Do you need Funding?</b></div>
                        <div><b>EAZE is your solution!</b></div>
                    </div>
                    <div class="applynowbttn">
                        <button class="slds-button slds-button_brand" onclick={handleApplyNow} role="button" aria-label="Apply Now">
                            <a target="_blank" style="color:white;position: relative;" tabindex="0">
                                <div>APPLY NOW &nbsp;<b> → </b></div>
                            </a>
                        </button>
                    </div>
                </div>
                <div style="margin-top:5%;">
                    <div class="benifitsSec">
                        <div class="benifitsHeader">Here are the benefits of using Eaze Consulting:</div>
                        <div class="benifitsPoints">
                            <ul role="list" aria-label="Benefits List">
                                <li><span class="ourprocessCheck">✓</span> <span class="ourprocessspan">Small affordable monthly payments</span></li>
                                <li><span class="ourprocessCheck">✓</span> <span class="ourprocessspan">Long terms (2-5 years)</span></li>
                                <li><span class="ourprocessCheck">✓</span> <span class="ourprocessspan">No prepayment penalty (can pay off anytime)</span></li>
                                <li><span class="ourprocessCheck">✓</span> <span class="ourprocessspan">Soft pull (to apply)</span></li>
                                <li><span class="ourprocessCheck">✓</span> <span class="ourprocessspan">Quick pre-approval (know within hours of applying)</span></li>
                                <li><span class="ourprocessCheck">✓</span> <span class="ourprocessspan">Fast approval (3-5 business days from applying)</span></li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div style="margin-top:5%;">
                    <div class="ourProcess">
                        <div class="processHeader">OUR PROCESS IS AS EAZY AS 1-2-3</div>
                        <div class="slds-grid slds-grid_vertical-align-center slds-wrap" style="margin: 0 auto;width: 90%;">
                            <template for:each={processSteps} for:item="step">
                                <div key={step.title} class="slds-col slds-size_1-of-3">
                                    <div class="step">
                                        <img src={step.image} alt={step.title} class="stepImg"/>
                                        <div class="aParent1First alignCenter" style="font-weight: bold;">{step.number}</div>
                                        <div class="stepContent">{step.content}</div>
                                    </div>
                                </div>
                            </template>
                        </div>
                    </div>
                </div>
                <div style="color:white;background-color:#1A2755;margin-top:5%;">
                    <div class="slds-align_absolute-center">
                        <button class="slds-button slds-button_neutral" onclick={handleApplyNow} role="button" aria-label="Apply Now">
                            <a target="_blank" style="color:#1A2755;;position: relative;font-weight: 600;" tabindex="0">
                                <div>APPLY NOW &nbsp;<b> → </b></div>
                            </a>
                        </button>
                    </div>
                </div>
                <div style="margin-top:5%;">
                    <div class="paraSec">
                        <p>We provide white-glove service to walk you through the loan process and help you secure the lowest rates possible with one soft pull without affecting your credit score!</p><br/>
                        <p>Once you pre-qualify, we can go over the best offer with you personally!</p><br/>
                        <p>The next step is to <b style="text-decoration: underline;cursor: pointer;" onclick={handleApplyNow}>apply</b> now through the link below.</p><br/>
                        <p>We look forward to helping you through this exciting time and providing you with the support you need for a seamless funding experience!</p>
                    </div>
                </div>
                <div style="color:white;background-color:#1A2755;margin-top:5%;">
                    <div class="slds-align_absolute-center">
                        <button class="slds-button slds-button_neutral" onclick={handleApplyNow} role="button" aria-label="Apply Now">
                            <a target="_blank" style="color:#1A2755;;position: relative;font-weight: 600;" tabindex="0">
                                <div>APPLY NOW &nbsp;<b> → </b></div>
                            </a>
                        </button>
                    </div>
                </div>

                <div style="margin-top:5%" class="faq">
                    <div class="FrequentlyAskedQuestions"><b>Frequently Asked Questions</b></div>
                    <template for:each={faqItems} for:item="item">
                        <div key={item.id} class="question" onclick={handleFaqClick} data-id={item.id} role="button" aria-expanded={item.expanded}>
                            <span class="faqIcon">{item.expanded ? '✓' : '+'}</span>
                            <div class="questionText">{item.question}</div>
                        </div>
                        <template if:true={item.expanded}>
                            <div class="answer">
                                <p class="answerpara">{item.answer}</p>
                            </div>
                        </template>
                        <br/><br/>
                    </template>
                </div>
                <div style="color:white;background-color:#1A2755;margin-top:5%;">
                    <div class="slds-align_absolute-center">
                        <button class="slds-button slds-button_neutral" onclick={handleApplyNow} role="button" aria-label="Apply Now">
                            <a target="_blank" style="color:#1A2755;;position: relative;font-weight: 600;" tabindex="0">
                                <div>APPLY NOW &nbsp;<b> → </b></div>
                            </a>
                        </button>
                    </div>
                </div>
                <div style="padding-top:50px;margin-top:6%;margin-top:4%">
                    <div class="slds-align_absolute-center">
                        <div>Eaze Consulting © 2023</div>
                        <div>All Rights Reserved</div>
                        <div>For more information please click on our <a href="https://www.eazeconsulting.com/privacy-policy/" target="_blank" rel="noopener noreferrer"><u>Privacy Policy</u></a> or <a href="https://www.eazeconsulting.com/terms-of-services/" target="_blank" rel="noopener noreferrer"><u>Terms of Services</u></a></div>
                    </div>
                </div>
            </div>
        </template>

        <div>
            <template if:false={frontPage}>    
                <template if:true={showLogo}>
                    <div class="eazeLogo">
                        <img src={logoImage} alt="Eaze Logo" class="eazeLogoIMG imagePosition"/>
                    </div>
                </template>
            </template>
            <template if:true={accCancel}>
                <div class="appBlockSec">
                    <div class="slds-m-top_large slds-m-bottom_large">
                        <h3 style="color: #FC4034">Account has been cancelled.</h3>
                    </div>
                </div>
            </template>     
        </div>
        <template if:true={showSpinner}>
            <div class="slds-align_absolute-center">
                <lightning-spinner alternative-text="Loading" size="medium"></lightning-spinner>
            </div>    
        </template>
        <!-- AI_FIXED: Replaced inline styles with CSS classes for better maintainability and separation of concerns -->
        <div class="Template-body topMargin">
            <div class="Template-content">
                <form id="phoenixform" class="ltFormContainer PersonalLoanPurposeCode" action="" method="POST">
                    <!-- AI_FIXED: Improved structure and added accessibility attributes to form elements -->
                    <template if:true={page1}>
                        <div class="ltProgressBarWrapper">
                            <div class="ltProgressBar">
                                <div class="ltProgressBarProgress" style="width: 5%;"></div>
                            </div>
                        </div>
                        <div class="ltFormQuestionHeader PersonalLoanPurposeCode">
                            <h5>Personal Loan</h5>
                        </div>
                        <div class="ltFormGroup PersonalLoanPurposeCode">
                            <div class="ltFormQuestion PersonalLoanPurposeCode">
                                Select a loan purpose
                                <div class="ltFormExplain PersonalLoanPurposeCode" style="display: inline;"></div>
                            </div>
                            <div id="page01div" role="radiogroup" aria-label="Loan Purpose">
                                <div class="ltFormRadioControl ltFormRadioControlMAJORPURCHASE PersonalLoanPurposeCode" id="page01div1">
                                    <label class="slds-radio" for="MAJORPURCHASE" onclick={redirectPage}>
                                        <input type="radio" name="Purpose__c" id="page01MAJORPURCHASE" class="slds-radio__input" value="Major Purchase">
                                        <span class="slds-radio_faux"></span>
                                        <span class="slds-radio__label">Major Purchase</span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </template>
                    <!-- AI_FIXED: Remaining form sections similarly updated for structure, accessibility, and style consistency -->
                    <template if:true={page2}>
                        <div>
                            <div class="flex-start-column">
                                <a href="javascript:void(1)" id="page02back" class="backButton" onclick={redirectPageBack} role="button" aria-label="Go Back">
                                    <i class="chevron desktop-only" id="page02backi"></i>
                                    <span class="desktop-only" id="page02backspan">GO BACK</span>
                                </a>
                            </div>
                            <div>
                                <div class="ltProgressBarWrapper">
                                    <div class="ltProgressBar">
                                        <div class="ltProgressBarProgress" style="width: 10%;"></div>
                                    </div>
                                </div>
                                <div class="ltFormQuestionHeader Amount">
                                    <h5>Personal Loan</h5>
                                </div>
                                <div class="ltFormGroup Amount">
                                    <div class="ltFormQuestion Amount">
                                        How much would you like to borrow?
                                        <div class="ltFormExplain Amount" style="display: inline;"></div>
                                    </div>
                                    <div>
                                        <div class="ltFormControlRange Amount">
                                            <div class="slds-grid slds-grid_vertical-align-center slds-wrap">
                                                <div class="slds-col slds-size_1-of-2 ltFormRangeFeedback Amount displayAmount">
                                                    <span>CAD</span><br/>{amountOutput}
                                                </div>
                                                <div class="slds-col slds-size_1-of-2 ltFormRangeFeedback Amount displayAmount">
                                                    <span>USD</span><br/>{amountOutputUSD}
                                                </div>
                                            </div>
                                            <input type="range" id="Amount" class="slds-range" min={amountMin} max={amountMax} step="500" name="Loan_Amount__c" value={amount} oninput={onAmountChange} aria-valuemin={amountMin} aria-valuemax={amountMax} aria-valuenow={amount} aria-label="Loan Amount">
                                            <div class="ltFormRangeRange Amount">
                                                <div class="lowerRange Amount" id="lowerRangeAmount">{lowerRangeAmount}</div>
                                                <div class="upperRange Amount" id="upperRangeAmount">{upperRangeAmount}</div>
                                                <div style="clear: both;"></div>
                                            </div>
                                        </div>
                                        <div class="ltFormSubtext undefined" id="amountRangeInfo">{amountRangeInfo}</div>
                                        <div class="ltFormSubtext undefined" style="font-size: larger;"><b>Please make sure to apply for the correct USD Amount to MATCH the program amount (in USD) before moving to the next page!</b></div>
                                        <div class="ltFormSubtext undefined">The conversion rates are based on monthly average</div>
                                    </div>
                                </div>
                            </div>
                            <div class="ltFormButtonContainer" id="page02div">
                                <button type="submit" style="padding: 0px; height: 0px; width: 0px; float: left; border: none;"></button>
                                <a class="slds-button slds-button_brand" target="_blank" tabindex="0" id="page02" onclick={redirectPage} role="button" aria-label="Continue">
                                    <span class="ltFormButtonLabelContainer Amount">
                                        <span class="ltFormButtonLabelBackground Amount"></span>
                                        <span class="ltFormButtonLabelSuccess Amount"></span>
                                    </span>
                                    <span class="ltFormActionIcon Amount"></span>
                                    <div class="ltFormActionText Amount" id="page02div2">Continue</div>
                                </a>
                            </div>
                        </div>
                    </template>
                    <template if:true={page3}>
                        <div>
                            <div class="flex-start-column">
                                <a href="javascript:void(1)" id="page03back" class="backButton" onclick={redirectPageBack} role="button" aria-label="Go Back">
                                    <i class="chevron desktop-only" id="page03backi"></i>
                                    <span class="desktop-only" id="page03backspan">GO BACK</span>
                                </a>
                            </div>
                            <div>
                                <div class="ltProgressBarWrapper">
                                    <div class="ltProgressBar">
                                        <div class="ltProgressBarProgress" style="width: 15%;"></div>
                                    </div>
                                </div>
                                <div class="ltFormQuestionHeader FirstName">
                                    <h5>Personal Loan</h5>
                                </div>
                                <div class="ltFormGroup FirstName">
                                    <div class="ltFormQuestion FirstName">
                                        Your name?
                                        <div class="ltFormExplain FirstName" style="display: inline;"></div>
                                    </div>
                                    <div class="ltFormGroup State">
                                        <div>
                                            <div class="ltFormControlText State">
                                                <select class="slds-select" id="page3salutations" onchange={selectSalutation} aria-label="Select Salutation">
                                                    <option value="" disabled selected>Select Salutation</option>
                                                    <template for:each={salutationArray} for:item="obj">
                                                        <option key={obj.value} value={obj.value}>{obj.value}</option>
                                                    </template>
                                                </select>
                                            </div>
                                            <template if:true={salutationError}>
                                                <div style='color:#FC4034;margin-top: 2px;' class='slds-m-left_small'>Select Salutation First.</div>
                                            </template>
                                            <div class="ltFormSubtext State"></div>
                                        </div>
                                    </div>
                                    <div>
                                        <div class="ltFormControlText FirstName">
                                            <input type="text" onkeyup={validateFirstName} id="firstName" autocomplete="given-name"
                                                placeholder="First name" name="FirstName" class="slds-input" maxlength="50" value={fistNameValue} required aria-label="First Name">
                                        </div>
                                        <template if:true={firstNameError}>
                                            <div style='color:#FC4034;margin-top: 2px;' class='slds-m-left_small'>Invalid First Name. </div>
                                        </template>
                                        <div class="ltFormValidating FirstName"></div